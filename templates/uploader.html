<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Upload File</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="/static/js/firebase-client.js"></script>
</head>
<body class="p-4">
  <h3>Upload File (Browser)</h3>
  <input type="file" id="fileInput" class="form-control mb-2">
  <button id="upload" class="btn btn-primary">Upload</button>
  <pre id="result"></pre>

<script>
document.getElementById('upload').addEventListener('click', async ()=>{
  const file = document.getElementById('fileInput').files[0];
  if(!file) { alert('select file'); return; }
  const token = await getIdToken();
  if(!token) { alert('login first'); return; }
  const form = new FormData();
  form.append('file', file);
  const res = await fetch('/api/upload_file', {
    method: 'POST',
    body: form,
    headers: { 'Authorization': 'Bearer ' + token }
  });
  const j = await res.json();
  document.getElementById('result').textContent = JSON.stringify(j, null, 2);
});
</script>
</body>
</html>
